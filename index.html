<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
    <!-- <button onClick="unsubscribe()">Unsubscribe</button> -->
    <button onClick="subscribe()">Subscribe</button>

    <script>
        async function subscribe() {
            try {
                const sw = await navigator.serviceWorker.ready;

                const push = await sw.pushManager.subscribe({
                    userVisibleOnly: true,
                    applicationServerKey: 'BKiaDTtzmTUggWqinNVXG_FUgtmfdIZFtDGLQ_bcmeacnv2JCUdwQ_-JiXxid-cPIw1N_pIit-XU4vQKqVHwk4E'
                });

                console.log(JSON.stringify(push));
            } catch (error) {
                console.log(error.message);
            }
        }

        if('serviceWorker' in navigator) {
            addEventListener('load', async () => {
                try {
                    const sw = await navigator.serviceWorker.register('./sw.js');

                    console.log(sw);
                } catch (error) {
                    console.log(error.message);
                }
            });
        }






        // addEventListener('load', async () => {
        //     let sw = await navigator.serviceWorker.register('./sw.js');
        //     console.log(sw);
        // });

        // async function unsubscribe() {
        //     let sw = await navigator.serviceWorker.ready;
        //     let subscription = await sw.pushManager.getSubscription();

        //     try {
        //         await subscription.unsubscribe();

        //         console.log('Successfully unsubscribed!');
        //     } catch (error) {
        //         console.log(error.message);
        //     }

        //     // await sw.pushManager.unsubscribe();
        //     // await navigator.serviceWorker.unsubscribe();
        // }

        // async function subscribe() {
        //     let sw = await navigator.serviceWorker.ready;
        //     let push = await sw.pushManager.subscribe({
        //         userVisibleOnly: true,
        //         applicationServerKey: 'BAWwzaQSWnr902LMsGhy9RIsCDOA2X1t2AJ1qjU0vtDAQCsu_oKGuLtE-vOxl4y1sfP1BNwTIQVnoXBCFPdTAHo'
        //     });

        //     console.log(JSON.stringify(push));
        // }
    </script>
</body>
</html>